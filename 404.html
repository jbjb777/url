<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>URL ë‹¨ì¶•ê¸° - ì •ë¹ˆ777</title>
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,
<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 2000 2000">
  <defs>
    <linearGradient id="linearGradient1" x1="1576.7" y1="1817" x2="423.3" y2="183" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="%233478f6" />
      <stop offset="1" stop-color="%2353b6f9" />
    </linearGradient>
    <filter id="filter1" x="0" y="0" width="2000" height="2000" color-interpolation-filters="sRGB">
      <feFlood flood-color="%23000000" flood-opacity="0.52" />
      <feComposite in2="SourceGraphic" operator="out" />
      <feGaussianBlur stdDeviation="43" />
      <feOffset dx="35" dy="24" />
      <feComposite in2="SourceGraphic" operator="atop" />
    </filter>
  </defs>
  <path fill="url(%23linearGradient1)" d="M 2000 1000 C 2000 448 1552 0 1000 0 C 448 0 0 448 0 1000 C 0 1552 448 2000 1000 2000 C 1552 2000 2000 1552 2000 1000 Z"/>
  <path fill="%23fff" filter="url(%23filter1)" d="M 1137 506 C 1252 449 1369 497 1427 625 L 1459 696 C 1484 752 1488 821 1471 878 L 1472 877 C 1535 891 1581 939 1608 997 L 1632 1052 C 1698 1199 1657 1324 1544 1381 L 1175 1565 L 972 1114 C 1002 1241 946 1377 834 1433 L 776 1462 C 654 1523 518 1467 449 1343 L 596 1269 C 625 1309 663 1331 708 1308 L 758 1283 C 813 1256 830 1185 802 1124 L 525 509 L 672 435 L 784 683 L 1137 506 Z M 1444 1232 C 1488 1210 1504 1149 1480 1095 L 1476 1085 C 1452 1033 1397 1007 1353 1029 L 1151 1130 L 1242 1333 L 1444 1232 Z M 1184 679 L 991 775 L 1084 981 L 1276 885 C 1319 864 1336 802 1312 749 L 1306 736 C 1283 684 1226 658 1184 679 Z"/>
</svg>' />
  
  <link rel="stylesheet" href="header.css">
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #121212;
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    .content-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      flex: 1;
      padding: 20px;
    }
    
    .container {
      max-width: 600px;
      width: 100%;
      margin: 60px auto;
      text-align: center;
      background: #1e1e1e;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 0 30px rgba(0,0,0,0.6);
    }
    
    h1 {
      color: #ffffff;
      margin-bottom: 30px;
    }
    
    #urlInput {
      width: 80%;
      padding: 12px;
      border-radius: 12px;
      border: none;
      background: #2c2c2c;
      color: #fff;
      font-size: 16px;
      outline: none;
    }
    
    #shortenBtn {
      padding: 12px 24px;
      margin-left: 10px;
      border: none;
      background: #3663FF;
      color: white;
      border-radius: 30px;
      cursor: pointer;
      font-size: 16px;
      transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    #shortenBtn:hover {
      transform: translateY(-8px) scale(1.05);
    }
    
    #shortenBtn:active {
      background: #2952CC;
    }
    
    #result {
      margin-top: 30px;
      font-size: 1.1em;
      color: #fff;
    }
    
    #result a {
      color: #00bfff;
      text-decoration: none;
    }
    
    #result a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <!-- í—¤ë” ì»¨í…Œì´ë„ˆ -->
  <div id="header-container"></div>

  <div class="content-wrapper">
    <div class="container" id="mainContainer" style="display:none;">
      <h1>ğŸ”— URL ë‹¨ì¶•ê¸°</h1>
      <input id="urlInput" type="text" placeholder="ë‹¨ì¶•í•  URL ì…ë ¥ (ì˜ˆ: https://naver.com)">
      <button id="shortenBtn">ë‹¨ì¶•í•˜ê¸°</button>
      <p id="result"></p>
    </div>
  </div>

  <!-- ê³µí†µ í—¤ë” JavaScript -->
  <script src="header.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
    
    const firebaseConfig = {
      apiKey: "AIzaSyB8OHhR0Vjan_nNdCczb5e2bOuDBYYRiIg",
      authDomain: "urlshare-718c1.firebaseapp.com",
      databaseURL: "https://urlshare-718c1-default-rtdb.firebaseio.com",
      projectId: "urlshare-718c1",
      storageBucket: "urlshare-718c1.firebasestorage.app",
      messagingSenderId: "666729308999",
      appId: "1:666729308999:web:a7f6d363e88b1d5ed5a262",
      measurementId: "G-VZH9BNQ3VR"
    };
    
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const path = window.location.pathname.slice(1);
    
    function generateCode(length = 6) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      for (let i = 0; i < length; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
      return result;
    }
    
    if (path) {
      const dbRef = ref(db);
      get(child(dbRef, `urls/${path}`))
        .then(snapshot => {
          if (snapshot.exists()) {
            window.location.href = snapshot.val().original;
          } else {
            document.querySelector('.content-wrapper').innerHTML = `
              <div class="container" style="display:block;">
                <h2>âŒ ë‹¨ì¶• ë§í¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h2>
              </div>
            `;
          }
        })
        .catch(err => {
          document.querySelector('.content-wrapper').innerHTML = `
            <div class="container" style="display:block;">
              <h2>âš ï¸ ì˜¤ë¥˜ë°œìƒ: ${err.message}</h2>
            </div>
          `;
        });
    } else {
      document.getElementById('mainContainer').style.display = 'block';
      
      const input = document.getElementById("urlInput");
      const btn = document.getElementById("shortenBtn");
      const result = document.getElementById("result");
      
      btn.addEventListener("click", async () => {
        const longUrl = input.value.trim();
        if (!longUrl.startsWith("http://") && !longUrl.startsWith("https://")) {
          alert("URLì€ ë°˜ë“œì‹œ http:// ë˜ëŠ” https:// ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤!");
          return;
        }
        const code = generateCode();
        await set(ref(db, `urls/${code}`), { original: longUrl });
        const shortUrl = `https://url.jbjb.r-e.kr/${code}`;
        result.innerHTML = `âœ… ë‹¨ì¶• URL: <a href="${shortUrl}" target="_blank">${shortUrl}</a>`;
      });
    }
  </script>
</body>
</html>
